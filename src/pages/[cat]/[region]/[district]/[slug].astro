---
import BaseLayout from '../../../../layouts/BaseLayout.astro';
import FAQ from '../../../../components/FAQ.astro';
import TrustBlock from '../../../../components/TrustBlock.astro';
import venuesData from '../../../../data/venues.json';
import { generateAllContent, nameHash, hookTitles } from '../../../../lib/venue-content';
import type { Venue } from '../../../../lib/venue-content';
import { dedupeVenuePathParams, venueDetailPath } from '../../../../lib/slug-utils';

/* ───────── getStaticPaths ───────── */
export function getStaticPaths() {
  return venuesData
    .filter((v: any) => !v.detail_page)
    .map((v: any) => {
      const dd = dedupeVenuePathParams(v.cat_slug, v.region_slug, v.district_slug, v.slug);
      return {
        params: {
          cat: v.cat_slug,
          region: v.region_slug,
          district: dd.district,
          slug: dd.slug,
        },
        props: { venue: v },
      };
    });
}

/* ───────── props & content gen ───────── */
const { venue } = Astro.props as { venue: Venue };
const idx = venuesData.findIndex((v: any) => v.slug === venue.slug);
const h = nameHash(venue.name);
const content = generateAllContent(venue, idx);

/* ───────── helpers ───────── */
const catLabel = venue.category;
const catEn = venue.cat_slug;
const regionLabel = venue.region;
const siteUrl = 'https://informationa.pages.dev';
const pageUrl = `${siteUrl}${venueDetailPath(venue)}`;
const catFullLabel = catLabel === '클럽' ? '클럽' : catLabel === '나이트' ? '나이트' : '라운지';

/* Thumbnail */
const thumbPath = venue.thumbnail || '/images/og-thumb.jpg';
const thumbAbsolute = thumbPath.startsWith('http') ? thumbPath : `${siteUrl}${thumbPath}`;
const thumbAlt = `${venue.name} ${regionLabel} ${venue.district} ${catFullLabel} — 내부 분위기와 인테리어`;

/* Map URL: use venue.map_url if available, else Google Maps search fallback */
const mapUrl = venue.map_url || `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(venue.name + ' ' + regionLabel)}`;

/* Last updated date */
const lastUpdated = '2026.02.21';

/* Hero taglines */
const heroTaglines: Record<string, string[]> = {
  club: ['오늘 밤 선택할 비트의 목적지', '사운드가 몸을 깨우는 순간', '밤의 에너지를 온몸으로 느끼다', '비트 위에서 시작되는 새로운 밤', '음악과 조명이 만드는 비일상', '새벽까지 멈추지 않는 리듬'],
  night: ['가요와 댄스가 흐르는 플로어', '익숙한 노래가 새롭게 울리는 밤', '모두가 하나 되는 댄스 플로어', '리듬에 맡기면 발이 저절로 움직인다', '밤의 열기 속으로 한 발짝'],
  lounge: ['대화와 음악이 균형을 이루는 밤', '차분한 조명 아래 특별한 시간', '소리보다 분위기가 먼저 닿는 밤', '프라이빗한 시간을 위한 선택', '볼륨 대신 분위기를 높이다'],
};
const heroTag = heroTaglines[catEn]?.[h % (heroTaglines[catEn]?.length || 1)] || '밤의 에너지를 온몸으로 느끼다';

/* Related venues */
const relatedVenues = venuesData
  .filter((v: any) => v.slug !== venue.slug && (v.category === venue.category || v.region === venue.region))
  .slice(0, 8);

/* SEO */
const hookTitle = hookTitles[venue.slug] || '';
const title = hookTitle
  ? `${venue.name} — ${hookTitle} | ${regionLabel} ${catFullLabel} 가이드 2026`
  : `${venue.name} | ${regionLabel} ${venue.district} ${catFullLabel} 위치·영업시간·입장료 가이드 2026`;
const stationShort = venue.station ? venue.station.split(',')[0].trim() : '';
const descParts = [
  `${venue.name}`,
  `${regionLabel} ${venue.district} ${catFullLabel}`,
  stationShort ? `${stationShort} 근처` : '',
  venue.tags?.length ? venue.tags.slice(0, 3).join('·') : '',
  '위치·영업시간·입장료·복장·예약 정보를 한 페이지에 정리',
].filter(Boolean);
const descRaw = descParts.join(' — ');
const description = descRaw.length > 155 ? descRaw.slice(0, 152) + '...' : descRaw;

/* Keywords meta */
const baseKeywords = venue.keywords || [];
const extraKeywords = [
  venue.name,
  `${regionLabel} ${catFullLabel}`,
  `${venue.district} ${catFullLabel}`,
  `${venue.name} 위치`,
  `${venue.name} 영업시간`,
  `${venue.name} 입장료`,
  `${venue.name} 후기`,
  `${regionLabel} ${venue.district} ${catFullLabel} 추천`,
  stationShort ? `${stationShort} ${catFullLabel}` : '',
].filter(Boolean);
const allKeywords = [...new Set([...baseKeywords, ...extraKeywords])].join(',');

/* Article meta for Naver freshness signals */
const publishedTime = '2025-12-01T00:00:00+09:00';
const modifiedTime = new Date().toISOString();

/* Practical guide rows */
const guideRows = [
  { label: '운영시간', value: venue.hours || '확인 필요 — 방문 전 전화 문의 권장' },
  { label: '위치 / 교통', value: `${venue.address} · ${venue.station}` },
  { label: '예약 / 입장', value: catEn === 'lounge' ? '사전 예약 권장 · 워크인 시 대기 가능' : catEn === 'club' ? '신분증 필수 · 주말은 사전 예약 유리' : '워크인 가능 · 주말 저녁은 일찍 도착 권장' },
  { label: '복장 / 분위기', value: catEn === 'club' ? '스마트캐주얼 이상 · 운동화 제한 가능' : catEn === 'lounge' ? '스마트캐주얼 이상 · 슬리퍼/반바지 불가' : '깔끔한 캐주얼 · 슬리퍼만 피하면 OK' },
  { label: '예산 감각', value: catEn === 'club' ? '입장료 1~3만 원 + 음료 1~2만 원/잔' : catEn === 'lounge' ? '음료 1.5~2.5만 원/잔 · 테이블 최소 주문 확인' : '입장료 0~2만 원 + 음료 0.5~1.5만 원/잔' },
];

/* JSON-LD */
const jsonLd = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "WebPage",
      "name": title,
      "url": pageUrl,
      "description": description,
      "primaryImageOfPage": { "@type": "ImageObject", "url": thumbAbsolute },
    },
    {
      "@type": "LocalBusiness",
      "name": venue.name,
      "url": pageUrl,
      "image": thumbAbsolute,
      "address": {
        "@type": "PostalAddress",
        "streetAddress": venue.address || '',
        "addressLocality": venue.district || '',
        "addressRegion": regionLabel,
        "addressCountry": "KR",
      },
      hasMap: mapUrl,
      ...(venue.phone ? { telephone: venue.phone } : {}),
      ...(venue.hours ? { openingHours: venue.hours } : {}),
    },
    {
      "@type": "BreadcrumbList",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "홈", "item": siteUrl + "/" },
        { "@type": "ListItem", "position": 2, "name": catFullLabel, "item": `${siteUrl}/${venue.cat_slug}/` },
        { "@type": "ListItem", "position": 3, "name": regionLabel, "item": `${siteUrl}/${venue.cat_slug}/${venue.region_slug}/` },
        { "@type": "ListItem", "position": 4, "name": venue.name, "item": pageUrl },
      ],
    },
    {
      "@type": "FAQPage",
      "mainEntity": content.faqItems.map((item) => ({
        "@type": "Question",
        "name": item.q,
        "acceptedAnswer": { "@type": "Answer", "text": item.a },
      })),
    },
  ],
};

/* Section IDs for navigation */
const sections = [
  { id: 'ai-summary', label: '요약' },
  { id: 'intro', label: '소개' },
  { id: 'prologue', label: '프롤로그' },
  { id: 'scene1', label: '선택의 순간' },
  { id: 'scene2', label: '첫인상' },
  { id: 'quick-plan', label: '퀵플랜' },
  { id: 'checklist', label: '체크리스트' },
  { id: 'faq-section', label: 'Q&A' },
  { id: 'bottom-cta', label: '마무리' },
];
---

<BaseLayout title={title} description={description} ogImage={thumbPath} jsonLd={jsonLd}>
  <Fragment slot="head">
    <meta name="keywords" content={allKeywords} />
    <meta property="article:section" content={`${regionLabel} ${catFullLabel}`} />
    <meta property="article:published_time" content={publishedTime} />
    <meta property="article:modified_time" content={modifiedTime} />
    <meta property="article:tag" content={venue.name} />
    <meta property="article:tag" content={`${regionLabel} ${catFullLabel}`} />
    <meta property="og:image:alt" content={thumbAlt} />
  </Fragment>
  <main id="main-content" class="detail-page">

    {/* ── Reading Progress Bar ── */}
    <div class="reading-progress" id="reading-progress" aria-hidden="true">
      <div class="reading-progress__bar" id="reading-progress-bar"></div>
    </div>

    {/* ── [0] Detail Hero ── */}
    <section class="detail-hero" data-reveal>
      {/* 1) Thumbnail at top */}
      <figure class="detail-hero__figure">
        <img
          src={thumbPath}
          alt={thumbAlt}
          width="520"
          height="520"
          loading="eager"
        />
      </figure>

      {/* 2) H1 = Store Name */}
      <h1 class="detail-hero__title">{venue.name}</h1>

      {/* 3) Quick meta row */}
      <div class="detail-hero__meta">
        <span class="detail-hero__meta-item">{catFullLabel}</span>
        <span class="detail-hero__meta-sep">·</span>
        <span class="detail-hero__meta-item">{regionLabel} {venue.district}</span>
        <span class="detail-hero__meta-sep">·</span>
        <span class="detail-hero__meta-item detail-hero__meta-date">업데이트 {lastUpdated}</span>
      </div>

      {/* 4) CTA row */}
      <div class="detail-hero__ctas">
        <a href={mapUrl} class="btn btn--primary" target="_blank" rel="noopener noreferrer">지도에서 보기</a>
        <a href="/" class="btn btn--outline" target="_blank" rel="noopener noreferrer">다른 장소 둘러보기</a>
      </div>
    </section>

    {/* ── [0.5] Value Hook Intro ── */}
    <section class="detail-hero-intro" data-reveal>
      <p class="detail-hero-intro__tagline">{heroTag}</p>
      <div class="quick-summary">
        <h2 class="quick-summary__title">핵심 요약</h2>
        <ul>
          <li><strong>카테고리:</strong> {catFullLabel}</li>
          <li><strong>지역:</strong> {regionLabel} · {venue.address}</li>
          <li><strong>교통:</strong> {venue.station || '확인 필요'}</li>
          <li><strong>운영 참고:</strong> {venue.hours || '확인 필요'}</li>
          {venue.phone && <li><strong>연락처:</strong> {venue.phone}</li>}
        </ul>
      </div>
    </section>

    {/* ── Reading Time + Section Nav ── */}
    <div class="reading-meta" data-reveal>
      <span class="reading-meta__time">약 {content.readingTimeMin}분</span>
      <nav class="reading-meta__nav" aria-label="섹션 이동">
        {sections.map(s => (
          <a href={`#${s.id}`} class="reading-meta__link" target="_blank" rel="noopener noreferrer">{s.label}</a>
        ))}
      </nav>
    </div>

    {/* ── [AI] Summary Block ── */}
    <section class="ai-summary" id="ai-summary" data-reveal>
      <h2 class="ai-summary__title">{venue.name} — 핵심 정보 요약</h2>
      <ul class="ai-summary__list">
        {content.aiSummary.map(bullet => (
          <li>{bullet}</li>
        ))}
      </ul>
    </section>

    {/* ── [A] VALUE HOOK INTRO ── */}
    <section class="value-intro" id="intro" data-reveal>
      <p class="value-intro__hook">{content.introHook}</p>

      <div class="value-intro__value-box">
        <h2 class="value-intro__value-title">이 페이지에서 얻는 것</h2>
        <ul class="value-intro__bullets">
          {content.introBullets.map(b => <li>{b}</li>)}
        </ul>
      </div>

      <div class="value-intro__teaser">
        <p>{content.introTeaser}</p>
      </div>
    </section>

    {/* ── [B-1] 3분 프롤로그 ── */}
    <section class="story-section" id="prologue" data-reveal>
      <h2 class="story-section__heading">3분 프롤로그</h2>
      <div class="story-section__body">
        <Fragment set:html={content.prologue} />
      </div>
    </section>

    {/* ── [B-2] 장면 1: 선택의 순간 ── */}
    <section class="story-section" id="scene1" data-reveal>
      <h2 class="story-section__heading">{content.scene1Title}</h2>
      <div class="story-section__body">
        <Fragment set:html={content.scene1} />
      </div>
    </section>

    {/* ── [B-3] 장면 2: 첫인상 디테일 ── */}
    <section class="story-section" id="scene2" data-reveal>
      <h2 class="story-section__heading">장면 2: 첫인상 디테일</h2>
      <div class="story-section__body">
        <Fragment set:html={content.scene2} />
      </div>
    </section>

    {/* ── Extra: Tip Section ── */}
    <section class="story-section" data-reveal>
      <div class="story-section__body story-section__extra">
        <Fragment set:html={content.tipSection} />
      </div>
    </section>

    {/* ── Extra: Dialogue / Twist Section ── */}
    <section class="story-section" data-reveal>
      <div class="story-section__body story-section__extra">
        <Fragment set:html={content.dialogueSection} />
      </div>
    </section>

    {/* ── [2] Practical Guide ── */}
    <section class="detail-section" data-reveal>
      <h2 class="detail-section__heading">실전 준비 가이드</h2>
      <div class="detail-table-wrap">
        <table class="detail-table">
          <tbody>
            {guideRows.map(row => (
              <tr>
                <th>{row.label}</th>
                <td>{row.value}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </section>

    {/* ── [B-5] 처음 가는 사람 체크리스트 ── */}
    <section class="detail-section" id="checklist" data-reveal>
      <h2 class="detail-section__heading">처음 가는 사람 체크리스트</h2>
      <ul class="checklist-list">
        {content.checklist.map(item => (
          <li class="checklist-list__item">
            <span class="checklist-list__icon" aria-hidden="true">&#10003;</span>
            <span>{item}</span>
          </li>
        ))}
      </ul>
    </section>

    {/* ── [QP] Quick Plan ── */}
    <section class="detail-section quick-plan" id="quick-plan" data-reveal>
      <h2 class="detail-section__heading">30초 결정표</h2>
      <div class="quick-plan__table-wrap">
        <table class="detail-table">
          <thead>
            <tr>
              <th>항목</th>
              <th>옵션 A</th>
              <th>옵션 B</th>
            </tr>
          </thead>
          <tbody>
            {content.quickPlan.decisionTable.map(row => (
              <tr>
                <th>{row.label}</th>
                <td>{row.optionA}</td>
                <td>{row.optionB}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      <h3 class="quick-plan__sub">3가지 방문 시나리오</h3>
      <div class="quick-plan__scenarios">
        {content.quickPlan.scenarios.map(s => (
          <div class="quick-plan__scenario">
            <strong>{s.title}</strong>
            <p>{s.desc}</p>
          </div>
        ))}
      </div>

      <p class="quick-plan__cost-note">{content.quickPlan.costNote}</p>
    </section>

    {/* ── [B-6] 실전 Q&A ── */}
    <FAQ items={content.faqItems} />

    {/* ── [5] Trust Block ── */}
    <TrustBlock storeName={venue.name} />

    {/* ── [B-7] 마무리(결론) ── */}
    <section class="story-section detail-bottom-cta" id="bottom-cta" data-reveal>
      <h2 class="story-section__heading">마무리</h2>
      <div class="story-section__body">
        <Fragment set:html={content.outro} />
      </div>
      <div class="story-section__ctas">
        <a href={mapUrl} class="btn btn--primary" target="_blank" rel="noopener noreferrer">지도에서 위치 확인하기</a>
        <a href="/" class="btn btn--outline" target="_blank" rel="noopener noreferrer">다른 장소 둘러보기</a>
      </div>
    </section>

    {/* ── [7] Related Venues ── */}
    {relatedVenues.length > 0 && (
      <section class="detail-section" data-reveal>
        <h2 class="detail-section__heading">함께 살펴볼 만한 곳</h2>
        <div class="detail-related">
          {relatedVenues.map((v: any) => (
            <a
              href={venueDetailPath(v)}
              class="detail-related__link"
              target="_blank"
              rel="noopener noreferrer"
            >
              <strong>{v.name}</strong>
              <span>{v.region} {v.category}</span>
            </a>
          ))}
        </div>
      </section>
    )}

  </main>
</BaseLayout>

<style is:global>
/* ═══ Detail Page — Dynamic Template Styles ═══ */
/* Using is:global so styles apply to set:html content (no data-astro-cid) */

/* ── Reading Progress Bar ── */
.reading-progress {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
  background: transparent;
  z-index: 9999;
  pointer-events: none;
}
.reading-progress__bar {
  height: 100%;
  width: 0%;
  background: var(--c-accent, #c8a86e);
  transition: width 80ms linear;
}

/* ── Reading Meta (time + nav) ── */
.detail-page .reading-meta {
  margin: 0 auto var(--sp-lg);
  padding: var(--sp-md) 0;
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  justify-content: center;
  gap: var(--sp-sm) var(--sp-lg);
}
.detail-page .reading-meta__time {
  font-size: var(--t-small);
  color: var(--c-muted);
  background: var(--c-bg-section);
  padding: 4px 12px;
  border-radius: 999px;
  white-space: nowrap;
}
.detail-page .reading-meta__nav {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sp-xs);
}
.detail-page .reading-meta__link {
  font-size: var(--t-caption);
  color: var(--c-text-soft);
  text-decoration: none;
  padding: 4px 10px;
  border: 1px solid var(--c-border);
  border-radius: 999px;
  transition: all .15s;
}
.detail-page .reading-meta__link:hover {
  background: var(--c-accent-soft);
  border-color: var(--c-accent);
  color: var(--c-accent-text);
  text-decoration: none;
}

/* ── Value Hook Intro ── */
.detail-page .value-intro {
  margin: 0 auto var(--section-gap);
  padding: 0;
  text-align: center;
}
.detail-page .value-intro__hook {
  font-family: var(--font-display);
  font-size: var(--t-h3);
  line-height: var(--lh-body);
  color: var(--c-text);
  margin-bottom: var(--sp-lg);
  padding: var(--sp-md) var(--sp-lg);
  background: var(--c-bg-warm);
  border-radius: var(--r-md);
  border-top: 3px solid var(--c-accent);
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}
.detail-page .value-intro__value-box {
  background: var(--c-bg-section);
  border-radius: var(--r-md);
  padding: var(--sp-lg);
  margin-bottom: var(--sp-lg);
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
  text-align: left;
}
.detail-page .value-intro__value-title {
  font-size: var(--t-body);
  font-weight: 700;
  margin-bottom: var(--sp-sm);
  color: var(--c-text);
  text-align: center;
}
.detail-page .value-intro__bullets {
  list-style: none;
  padding: 0;
  margin: 0;
}
.detail-page .value-intro__bullets li {
  position: relative;
  padding-left: 20px;
  margin-bottom: var(--sp-xs);
  font-size: var(--t-body);
  line-height: var(--lh-body);
  color: var(--c-text-soft);
}
.detail-page .value-intro__bullets li::before {
  content: '→';
  position: absolute;
  left: 0;
  color: var(--c-accent);
  font-weight: 700;
}
.detail-page .value-intro__teaser {
  background: var(--c-bg-warm);
  border-radius: var(--r-md);
  padding: var(--sp-lg);
  font-style: italic;
  color: var(--c-text-soft);
  line-height: var(--lh-body);
  border-top: 2px solid var(--c-accent-soft, rgba(200,168,110,.3));
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

/* ── Story Sections (set:html content) ── */
.detail-page .story-section {
  margin: 0 auto var(--section-gap);
  padding: 0;
}
.detail-page .story-section__heading {
  font-family: var(--font-display);
  font-size: var(--t-h2);
  line-height: var(--lh-heading);
  color: var(--c-navy);
  margin-bottom: var(--sp-lg);
  padding-bottom: var(--sp-sm);
  border-bottom: 2px solid var(--c-accent-soft, rgba(200,168,110,.2));
  text-align: center;
}
.detail-page .story-section__body {
  font-size: var(--t-body);
  line-height: var(--lh-body);
  color: var(--c-text-soft);
  max-width: 68ch;
  margin-left: auto;
  margin-right: auto;
}
.detail-page .story-section__body p {
  margin-bottom: var(--sp-md);
}
.detail-page .story-section__body h3 {
  font-family: var(--font-display);
  font-size: var(--t-h3);
  color: var(--c-navy);
  margin-top: var(--sp-xl);
  margin-bottom: var(--sp-md);
  text-align: center;
}
.detail-page .story-section__body .dialogue {
  background: var(--c-bg-section);
  padding: var(--sp-md) var(--sp-lg);
  border-radius: var(--r-md);
  font-style: italic;
  margin: var(--sp-lg) auto;
  border-top: 3px solid var(--c-accent);
  text-align: center;
  max-width: 400px;
}
.detail-page .story-section__ctas {
  display: flex;
  flex-wrap: wrap;
  gap: var(--sp-sm);
  margin-top: var(--sp-xl);
  justify-content: center;
}

/* ── Checklist ── */
.detail-page .checklist-list {
  list-style: none;
  padding: 0;
  margin: 0 auto;
  max-width: var(--max-narrow, 720px);
}
.detail-page .checklist-list__item {
  display: flex;
  align-items: flex-start;
  gap: var(--sp-sm);
  padding: var(--sp-sm) 0;
  border-bottom: 1px solid var(--c-border-light);
  font-size: var(--t-body);
  line-height: var(--lh-body);
  color: var(--c-text-soft);
}
.detail-page .checklist-list__icon {
  flex-shrink: 0;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--c-accent-soft);
  color: var(--c-accent-text);
  border-radius: 50%;
  font-size: 12px;
  font-weight: 700;
  margin-top: 3px;
}

/* ── AI Summary Block ── */
.detail-page .ai-summary {
  margin: 0 auto var(--section-gap);
  padding: var(--sp-lg);
  background: var(--c-bg-section);
  border-radius: var(--r-md, 12px);
  border-top: 4px solid var(--c-accent);
  max-width: 600px;
}
.detail-page .ai-summary__title {
  font-family: var(--font-display);
  font-size: var(--t-h3);
  color: var(--c-navy);
  margin-bottom: var(--sp-md);
  line-height: var(--lh-heading);
  text-align: center;
}
.detail-page .ai-summary__list {
  list-style: none;
  padding: 0;
  margin: 0;
  text-align: left;
}
.detail-page .ai-summary__list li {
  position: relative;
  padding-left: 22px;
  margin-bottom: var(--sp-xs);
  font-size: var(--t-body);
  line-height: var(--lh-body);
  color: var(--c-text-soft);
}
.detail-page .ai-summary__list li::before {
  content: '•';
  position: absolute;
  left: 6px;
  color: var(--c-accent);
  font-weight: 700;
  font-size: 1.1em;
}

/* ── Quick Plan ── */
.detail-page .quick-plan__table-wrap {
  overflow-x: auto;
  margin-bottom: var(--sp-lg);
}
.detail-page .quick-plan__sub {
  font-family: var(--font-display);
  font-size: var(--t-h3);
  color: var(--c-navy);
  margin-bottom: var(--sp-md);
  text-align: center;
}
.detail-page .quick-plan__scenarios {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--sp-sm);
  margin-bottom: var(--sp-lg);
}
.detail-page .quick-plan__scenario {
  background: var(--c-bg-section);
  border: 1px solid var(--c-border-light);
  border-radius: var(--r-md, 12px);
  padding: var(--sp-md);
}
.detail-page .quick-plan__scenario strong {
  display: block;
  color: var(--c-navy);
  margin-bottom: var(--sp-xs);
  font-size: var(--t-body);
}
.detail-page .quick-plan__scenario p {
  margin: 0;
  font-size: var(--t-small);
  line-height: var(--lh-body);
  color: var(--c-text-soft);
}
.detail-page .quick-plan__cost-note {
  font-size: var(--t-small);
  color: var(--c-muted);
  font-style: italic;
  line-height: var(--lh-body);
  padding: var(--sp-sm) var(--sp-md);
  background: var(--c-bg-warm);
  border-radius: var(--r-sm, 8px);
  text-align: center;
}

/* ── Detail Hero — Enhanced ── */
.detail-page .detail-hero {
  text-align: center;
  padding: var(--sp-xl) 0 var(--sp-lg);
}
.detail-page .detail-hero__figure {
  display: flex;
  justify-content: center;
  margin: 0 auto var(--sp-lg);
  max-width: 480px;
}
.detail-page .detail-hero__figure img {
  width: 100%;
  max-width: 480px;
  aspect-ratio: 1 / 1;
  object-fit: cover;
  border-radius: 18px;
  box-shadow: 0 8px 32px rgba(15, 23, 42, 0.10);
}
.detail-page .detail-hero__title {
  font-family: var(--font-display);
  font-size: var(--t-h1);
  font-weight: 700;
  line-height: 1.3;
  color: var(--c-navy);
  margin-bottom: var(--sp-sm);
}
.detail-page .detail-hero__meta {
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
  gap: 4px 6px;
  font-size: var(--t-small);
  color: var(--c-muted);
  margin-bottom: var(--sp-lg);
}
.detail-page .detail-hero__ctas {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: var(--sp-sm);
}

/* ── Detail Hero Intro ── */
.detail-page .detail-hero-intro {
  padding: 0 0 var(--sp-lg);
}
.detail-page .detail-hero-intro__tagline {
  font-family: var(--font-display);
  font-size: var(--t-h3);
  font-style: italic;
  color: var(--c-text-soft);
  line-height: var(--lh-body);
  margin-bottom: var(--sp-lg);
  text-align: center;
}

/* ── Mobile responsive ── */
@media (max-width: 599px) {
  .detail-page .detail-hero__figure { max-width: 100%; }
  .detail-page .detail-hero__figure img { border-radius: 14px; }
  .detail-page .detail-hero__ctas { flex-direction: column; }
  .detail-page .detail-hero__ctas .btn { width: 100%; text-align: center; }
}
</style>

<script>
  // Reading progress bar
  const bar = document.getElementById('reading-progress-bar');
  if (bar) {
    const update = () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      if (docHeight > 0) {
        const pct = Math.min(100, (scrollTop / docHeight) * 100);
        bar.style.width = pct + '%';
      }
    };
    window.addEventListener('scroll', update, { passive: true });
    update();
  }
</script>
