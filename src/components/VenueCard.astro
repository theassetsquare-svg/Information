---
interface Props {
  name: string;
  category: string;
  region: string;
  thumbnail: string;
  image_alt: string;
  badge?: string | null;
  card_hook: string;
  card_value: string;
  card_tags: string[];
  detail_page?: string | null;
  map_url: string;
}

const { name, category, region, thumbnail, image_alt, badge, card_hook, card_value, card_tags, detail_page, map_url } = Astro.props;
const href = detail_page || map_url;
const webpThumb = thumbnail.replace(/\.(png|jpe?g)$/i, '.webp');
const hasWebp = webpThumb !== thumbnail;
const catEnMap: Record<string, string> = { '클럽': 'Club', '라운지': 'Lounge', '나이트': 'Night' };
const catEn = catEnMap[category] || category;
---
<a class="venue-card" href={href} target="_blank" rel="noopener noreferrer">
  <div class="venue-card__thumb">
    {hasWebp ? (
      <picture>
        <source srcset={webpThumb} type="image/webp" />
        <img src={thumbnail} alt={image_alt} width="100" height="100" loading="lazy" decoding="async" />
      </picture>
    ) : (
      <img src={thumbnail} alt={image_alt} width="100" height="100" loading="lazy" decoding="async" />
    )}
    {badge && <span class="venue-card__badge">{badge}</span>}
  </div>
  <div class="venue-card__body">
    <div class="venue-card__meta">
      <span class="venue-card__type">{catEn}</span>
    </div>
    <h3 class="venue-card__name">{name}</h3>
    <p class="venue-card__hook">{card_hook}</p>
    <p class="venue-card__value">{card_value}</p>
    <div class="venue-card__tags">
      {card_tags.map(tag => <span class="pill">{tag}</span>)}
    </div>
    {detail_page && <span class="venue-card__cta">→</span>}
  </div>
</a>
